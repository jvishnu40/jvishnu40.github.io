---
title:      High Speed Data Transfer Using Tsunami-UDP
layout:     post
category:   DevOps
tags: 	    [aws]
---

অনেক বড় সাইজের ডাটা এক সার্ভার থেকে আরেকটা সার্ভারে কিভাবে পাঠাতে হয় সেটা নিয়ে আজকে আলোচনা করবো । ডাটা পাঠানোর ক্ষেত্রে বিবেচনার বিষয় হল ডাটা ট্রান্সফার স্পীড আর নির্ভরযোগ্যতা । তবে এই পোস্টে স্পীডের উপরে ফোকাস করা হবে । আর টার্গেটটা সম্পূর্ণ করার জন্য অ্যামাজন ক্লাউড কম্পিউটিং (AWS) এবং সুনামি-ইউডিপি (Tsunami-UDP) টুল ব্যবহার করা হয়েছে ।

সুনামি-ইউডিপি (Tsunami-UDP) কি ?

সুনামি-ইউডিপি একটা ওপেন সোর্স ফাইল ট্রান্সফার প্রোটোকল যেটা অনেক দ্রুত ফাইল ট্রান্সফার করতে পারে । যদিও প্রোডাকশন সিস্টেমে এর ব্যবহার কম । এটি একই সাথে TCP এবং UDP  উভয়ের সমন্বয়ে কাজ করে ।  UDP ব্যবহার করা হয় ডাটা ট্রান্সফার করার জন্য আর TCP ব্যবহার করা হয় ক্লায়েন্ট-সার্ভার যোগাযোগ বজায় রাখার জন্য । এই প্রোগ্রামটা ইন্সটল করলে দুইটা প্রোগ্রাম পাওয়া যাবে যার একটি হল সুনামি-সার্ভার (tsunamid) এবং অপরটি হল সুনামি-ক্লায়েন্ট (tsunami) । অ্যামাজন ক্লাউডে সুনামি-ইউডিপি ব্যবহার করে ফাইল পাঠানোর ক্ষেত্রে সার্ভার মেশিনের ফায়ারওয়াল আউটবাউন্ড রুল হিসেবে ৫১০৩৮ ইউডিপি পোর্ট ওপেন রাখতে হবে এবং ক্লায়েন্ট মেশিনে ফায়ারওয়াল ইনবাউন্ড রুল হিসেবে ৫১০৩৮ ইউডিপি পোর্ট ওপেন রাখতে হবে । কারণ সুনামি-ইউডিপি ডিফল্ট এই পোর্ট ব্যবহার করে ডাটা ট্রান্সফার করে । 

ফাইল ট্রান্সফার করার জন্য আমাদের দরকার একটা সার্ভার মেশিন (ধরে নিলাম এটি মেশিন A) যেখানে ফাইল থাকবে আর একটা ক্লায়েন্ট মেশিন (ধরে নিলাম এটি মেশিন B) যেখানে ফাইলটা পাঠানো হবে ।  আমি AWS এ দুইটা লিনাক্স ec2-instance তৈরি করবো যার একটি হবে সার্ভার এবং অপরটি হবে ক্লায়েন্ট মেশিন । দুইটা মেশিন তৈরি করার পরে আমাদের কাজ হবে সেখান পৃথক পৃথক ভাবে সুনামি-ইউডিপি (Tsunami-UDP) ইন্সটল করা ।  প্রোগ্রামটা সহজে ইন্সটল করার জন্য একটি স্ক্রিপ্ট আমি গিটহাবে (PROFILE) রেখেছি যেটা ব্যবহার করলে কাজটা অনেক সোজা হয়ে যাবে ।

$ sudo apt-get install git -y
$ git clone https://github.com/shudarshon/trans-tsunami.git
$ cd trans-tsunami  
$ chmod 754 *.sh
$ sudo ./provision.sh

এবার আমরা মেশিন A তে এক্সেস নিবো আর data নামক একটি ফোল্ডারে ৫ গিগাবাইট এর একটা ডামি ফাইল তৈরি করবো । ফাইলটা তৈরি করার জন্যে নিচের কমান্ডটা ব্যবহার করতে হবে

$ mkdir -p data
$ cd data
$ fallocate -l 5G dummy.file

ফাইল তৈরি করার পরের কাজ হবে সেটাকে কম্প্রেস করা । যদি অনেকগুলো ফাইল একসাথে ট্রান্সফার করার দরকার পরে সেগুলোকে আমরা কম্প্রেস করে একটি ফাইলে নিয়ে আসবো । ফাইল কম্প্রেস করার জন্য নিচের কমান্ডটা ব্যবহার করতে হবে, (ধরে নিচ্ছি, এখনও trans-tsunami/data ডিরেক্টরিতেই আমরা আছি) 

$ tar -cvzf data.tar.gz dummy.file 

ডাটা কম্প্রেস করার পরবর্তী কাজ হবে trans-tsunami ফোল্ডার থেকে "kill.sh"  ফাইলটা কপি করে এই ডিরেক্টরিতে রেখে দেওয়া । এই স্ক্রিপ্টটার কাজ হল সুনামি সার্ভার প্রথম ফাইল পাঠানো শেষ করলেই সার্ভার প্রোগ্রামটাকে বন্ধ করে দেওয়া । যেহেতু আমরা একটিমাত্র ফাইল পাঠাবো তাই ডাটা ক্লায়েন্টে পৌঁছানো মাত্রই সুনামি সার্ভার অটোম্যাটিক ভাবে বন্ধ হয়ে যাবে । স্ক্রিপ্টটা কপি করার জন্যে নিচের কমান্ডটা ব্যবহার করতে হবে, 

$ cp ../kill.sh .
 
উপরের কমান্ডটাতে সবার শেষে একটি সিঙ্গেল ডট ব্যবহার করা হয়েছে যেটা বর্তমান ডিরেক্টরিকে বোঝায় । এবার সুনামি সার্ভার ব্যবহার করে ফাইলটা পাঠানোর জন্যে নিচের কমান্ডটা ব্যবহার করবো

$ tsunamid --finishhook="./kill.sh" data.tar.gz > /dev/null 2>&1

সুনামি সার্ভার ডাটা পাঠানোর জন্যে রেডি এখন ক্লায়েন্ট মেশিন B তে এক্সেস নিয়ে সেখানে সুনামি ক্লায়েন্ট প্রোগ্রাম চালু করে ডাটা সংগ্রহ করবো । কিন্তু এটা করবার আগে আমাদের মেশিন A এর আইপি অ্যাড্রেস জানতে হবে । তারপরে নিচের কমান্ডটা ব্যবহার করতে হবে, 

$ tsunami connect SERVER_IP get \* quit > /dev/null 2>&1

দেখা যাবে যে, ডাটা অনেক দ্রুত ট্রান্সফার হয়েছে এবং সুনামি সার্ভার ও ক্লায়েন্ট উভয় প্রোগ্রামই অটোম্যাটিক ভাবে বন্ধ হয়ে গিয়েছে । সর্বশেষ আমাদের কাজ হবে চেকসাম ব্যবহার করে দেখা যে ডাটা মেশিন A এবং মেশিন B তে একই হ্যাশ রিটার্ন করে কিনা । যদি হ্যাশ একই হয় তাহলে বোঝা যাবে যে ডাটা অপরিবর্তিত অবস্থায় ট্রান্সফার হয়েছে । চেকসাম জানার জন্যে নিচের কমান্ডটা ব্যবহার করতে হবে 

$ md5sum data.tar.gz
